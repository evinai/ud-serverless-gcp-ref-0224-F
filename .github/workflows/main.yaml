name: Test, Build, and Push to Google Cloud run


on:
    workflow_dispatch:
    push:
        branches:
            - "master"


jobs:
    test:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
            - name: Setup Python
              uses: actions/setup-python@v5
              with:
                python-version: "3.8"
            - name: Install requirements
              run: |
                python -m pip install -r src/requirements.txt
            - name: Run tests
              env:
                MODE: "github actions"
              run: |
                pytest src/tests.py

    # build_deploy:
    #     needs: test
    #     runs-on: ubuntu-latest